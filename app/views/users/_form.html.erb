<%= nested_form_for @user do |f| %>
  <% if @user.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@user.errors.count, "error") %> prohibited this user from being saved:</h2>

      <ul>
      <% @user.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :first_name %><br />
    <%= f.text_field :first_name %>
  </div>
  <div class="field">
    <%= f.label :second_name %><br />
    <%= f.text_field :second_name %>
  </div>
  <div class="field">
    <%= f.label :home_country %><br />
    <%= f.select :home_country, countries_list %>
  </div>
  <div class="field">
    <%= f.label :phone_number %><br />
    <%= f.text_field :phone_number %>
  </div>
  <div class="field">
    <%= f.label :email_address %><br />
    <%= f.text_field :email_address %>
  </div>
  <div class="field">
    <%= f.label :price_method %><br />
    <%= f.select :price_method, price_method_list %>
  </div>
  <div class="field">
    <%= f.label :price_category %><br />
    <%= f.select :price_category, price_category_list %>
  </div>
  <div class="field">
    <%= f.label :payment %><br />
    <%= f.text_field :payment %>
  </div>
  <h2><%= t 'meals' %></h2>
  <%= f.fields_for :meals, :wrapper => false do |f2| %>
    <%= render 'meal_fields', f: f2 %>
  <% end %>
  <%= f.link_to_add t('add_more_meals'), :meals %>
  </table>
  <h2><%= t 'children' %></h2>
  <%= f.fields_for :children do |builder| %>
    <%= render 'child_fields', f: builder %>
  <% end %>
  <%= f.link_to_add t('add_children'), :children %>
  <h2><%= t 'registrations' %></h2>
  <table>
  <tr>
    <th><%= Program.human_attribute_name(:event_date) %></th>
    <th><%= Program.human_attribute_name(:program_name_hu) %></th>
    <th><%= Program.human_attribute_name(:program_name_en) %></th>
    <th><%= Program.human_attribute_name(:price_full) %></th>
    <th><%= Program.human_attribute_name(:price_member) %></th>
    <th><%= Program.human_attribute_name(:price_discount) %></th>
    <th></th>
  </tr>
<% @programs.each do |program| %>
  <tr>
    <td><%= program.event_date %></td>
    <td><%= program.program_name_hu %></td>
    <td><%= program.program_name_en %></td>
    <td><%= program.price_full %></td>
    <td><%= program.price_member %></td>
    <td><%= program.price_discount %></td>
    <td>
    <%= f.fields_for :registrations do |reg| %>
      <%= reg.check_box :participate  %>
      <%= reg.hidden_field :program_id, :value => program.id %>
    <% end %>
    </td>
  </tr>
<% end %>
</table> 
<h2><%= t 'travel' %></h2>
<p><%= t 'travel_description' %></p>
  <%= f.fields_for :travels do |travel| %>
  <fieldset>
  <div class="field">
    <%= travel.label :bus_trip %><br />
    <%= travel.check_box :bus_trip %>
  </div>
  <div class="field">
    <%= travel.label :arrival %><br />
    <%= travel.select(:arrival, [['2013-07-12 11:00', '2013-07-12 11:00'], ['2013-07-12 11:00', '2013-07-12 15:00']]) %>
  </div>
  <div class="field">
    <%= travel.label :arrival_seats %><br />
    <%= travel.select(:arrival_seats, (0...6)) %>
  </div>
  <div class="field">
    <%= travel.label :departure %><br />
    <%= travel.select(:departure, [['2013-07-18 20:00', '2013-07-18 20:00'],['2013-07-18 20:00', '2013-07-18 20:00']]) %>
  </div>
  <div class="field">
    <%= travel.label :departure_seats %><br />
    <%= travel.select(:departure_seats, (0...6)) %>
  </div>
  <div class="field">
    <%= travel.label :flight_date %><br />
    <%= travel.datetime_select :flight_date %>
  </div>
  <div class="field">
    <%= travel.label :flight_number %><br />
    <%= travel.text_field :flight_number %>
  </div>
  </fieldset>
  <% end %>
    <%= f.hidden_field :reference_number %>
  <div class="actions">
    <%= f.submit :class => 'RegistrationButton' =%>
  </div>
<% end %>